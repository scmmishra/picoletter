<tr>
  <td class="px-4 py-3 whitespace-nowrap">
    <div>
      <p class="text-sm font-medium text-stone-700"><%= membership.user.name %></p>
      <p class="text-sm font-sans text-stone-500"><%= membership.user.email %></p>
    </div>
  </td>
  <td class="px-4 py-3 whitespace-nowrap">
    <span
      class="
        px-2 py-1 text-[10px] font-medium uppercase tracking-widest
        font-sans text-stone-600 bg-stone-100 rounded
      "
    >
      <%= membership.role %>
    </span>
  </td>
  <td class="px-4 py-3 whitespace-nowrap text-right">
    <% if @newsletter.can_write?(:team) %>
      <div data-controller="modal" data-action="click->modal#backdropClose" class="relative inline-block">
        <button
          class="
            btn btn-sm btn-tinted btn-secondary opacity-40 transition-all
            duration-300 grayscale hover:grayscale-0 hover:opacity-100
            py-1.5
          "
          data-action="modal#open"
        >
          <%= lucide_icon("edit-2", class: "size-3 text-stone-800") %>
        </button>

        <!-- Modal Dialog -->
        <dialog
          data-modal-target="modal"
          class="
            p-6 pt-5 pb-7 bg-white overflow-hidden rounded-lg shadow-with-inset min-w-sm
            w-full max-w-lg gap-4 space-y-4 text-left
          "
        >
          <div class="space-y-6">
            <h2 class="text-xl font-semibold text-stone-800">
              Edit Team Member
            </h2>

            <div class="space-y-4">
              <div>
                <p class="font-medium text-stone-700"><%= membership.user.name %></p>
                <p class="text-sm text-stone-500"><%= membership.user.email %></p>
              </div>

              <%= labeled_form_with model: membership, url: settings_team_member_role_path(slug: @newsletter.slug, id: membership.id), method: :patch, local: true do |form| %>
                <%= form.select :role,
                    options_for_select([['Editor', 'editor'], ['Administrator', 'administrator']], membership.role),
                    {},
                    label: "Role",
                    class: "flex flex-col" %>

                <div class="flex gap-2 mt-6 justify-between">
                  <% confirm_message = "Are you sure you want to remove #{membership.user.name} from the team?" %>
                  <%= link_to "Remove Member",
                              settings_team_member_path(slug: @newsletter.slug, id: membership.id),
                              data: { turbo_method: :delete, turbo_confirm: confirm_message },
                              class: "btn btn-danger" %>
                  <div class="flex gap-2">
                    <button type="button" class="btn btn-secondary" data-action="modal#close">
                      Cancel
                    </button>
                    <%= form.submit "Update", class: "btn btn-primary" %>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        </dialog>
      </div>
    <% else %>
      <span class="text-sm text-stone-500">â€”</span>
    <% end %>
  </td>
</tr>
